Here are the detailed steps to automate installation of Self hosted Integration Runtime on Azure VM's

1. **Create Self hosted Integration runtime configuration within Azure data factory**: Please run the **adfshirdeploy.sh** script to configure Self hosted Integration runtime configuration within the specified Azure Data Factory. It deploys the *adf-template.json* and the corresponding parameter file *adf-template.parameters.json*. Please provide the existing Azure Data factory name as one of the input parameters. If you havent created data factory yet, please go to the folder [data-factory](https://github.com/microsoft/implementation-patterns/tree/main/pattern-datafactory-databricks/components/data-factory) where you can find the templates to create a brand new datafactory with or without CI\CD integration.


2. **Create a Windows VM which will act as the Self hosted Integration runtime node:** Please run the **windowsvmdeploy.sh** to deploy the Self hosted integration runtime VM within the specified Virtual network\subnet. As part of this deployment, it will deploy the ARM template *vm-windows.json*  , we will also install and configure the Integration runtime software as part of the custom script extension. Please note that you need to provide the **datafactory name** and **self hosted integration runtime name** obtained in the above step as input parameters within the *vm-windows.parameters.json* file. You can rerun this step upto 4 times to create upto 4 nodes for Self hosted integration runtime which can provide high availability,resiliency and scalability etc 

3. **Configure Self hosted integration runtime on an existing Windows VM:** Please note that in this case, the VM is already provisioned and you just need to run the powershell script **irCustominstall.ps1** script to configure Self hosted integration runtime programatically. It takes care of downloading the software, configuring with the provided AuthKey etc
